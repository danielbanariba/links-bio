import{r as e}from"./rolldown-runtime-o1kDnhdS.js";import{j as t}from"./chunk-EPOLDU6W-CIOSNN8S.js";import{D as n,E as r,O as i,T as a,k as o,w as s}from"./esm-CjmgHRK6.js";var c=e(t(),1),l=e(i(),1),u=`Label`,d=c.forwardRef((e,t)=>(0,l.jsx)(n.label,{...e,ref:t,onMouseDown:t=>{t.target.closest(`button, input, select, textarea`)||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));d.displayName=u;var[f,p]=r(`Form`),m=`Form`,[h,g]=f(m),[_,v]=f(m),y=c.forwardRef((e,t)=>{let{__scopeForm:r,onClearServerErrors:i=()=>{},...s}=e,u=o(t,c.useRef(null)),[d,f]=c.useState({}),p=c.useCallback(e=>d[e],[d]),m=c.useCallback((e,t)=>f(n=>({...n,[e]:{...n[e]??{},...t}})),[]),g=c.useCallback(e=>{f(t=>({...t,[e]:void 0})),w(t=>({...t,[e]:{}}))},[]),[v,y]=c.useState({}),b=c.useCallback(e=>v[e]??[],[v]),x=c.useCallback((e,t)=>{y(n=>({...n,[e]:[...n[e]??[],t]}))},[]),S=c.useCallback((e,t)=>{y(n=>({...n,[e]:(n[e]??[]).filter(e=>e.id!==t)}))},[]),[C,w]=c.useState({}),T=c.useCallback(e=>C[e]??{},[C]),E=c.useCallback((e,t)=>{w(n=>({...n,[e]:{...n[e]??{},...t}}))},[]),[D,O]=c.useState({});return(0,l.jsx)(h,{scope:r,getFieldValidity:p,onFieldValidityChange:m,getFieldCustomMatcherEntries:b,onFieldCustomMatcherEntryAdd:x,onFieldCustomMatcherEntryRemove:S,getFieldCustomErrors:T,onFieldCustomErrorsChange:E,onFieldValiditionClear:g,children:(0,l.jsx)(_,{scope:r,onFieldMessageIdAdd:c.useCallback((e,t)=>{O(n=>{let r=new Set(n[e]).add(t);return{...n,[e]:r}})},[]),onFieldMessageIdRemove:c.useCallback((e,t)=>{O(n=>{let r=new Set(n[e]);return r.delete(t),{...n,[e]:r}})},[]),getFieldDescription:c.useCallback(e=>Array.from(D[e]??[]).join(` `)||void 0,[D]),children:(0,l.jsx)(n.form,{...s,ref:u,onInvalid:a(e.onInvalid,e=>{let t=U(e.currentTarget);t===e.target&&t.focus(),e.preventDefault()}),onSubmit:a(e.onSubmit,i,{checkForDefaultPrevented:!1}),onReset:a(e.onReset,i)})})})});y.displayName=m;var b=`FormField`,[x,S]=f(b),C=c.forwardRef((e,t)=>{let{__scopeForm:r,name:i,serverInvalid:a=!1,...o}=e,c=g(b,r).getFieldValidity(i);return(0,l.jsx)(x,{scope:r,id:s(),name:i,serverInvalid:a,children:(0,l.jsx)(n.div,{"data-valid":J(c,a),"data-invalid":Y(c,a),...o,ref:t})})});C.displayName=b;var w=`FormLabel`,T=c.forwardRef((e,t)=>{let{__scopeForm:n,...r}=e,i=g(w,n),a=S(w,n),o=r.htmlFor||a.id,s=i.getFieldValidity(a.name);return(0,l.jsx)(d,{"data-valid":J(s,a.serverInvalid),"data-invalid":Y(s,a.serverInvalid),...r,ref:t,htmlFor:o})});T.displayName=w;var E=`FormControl`,D=c.forwardRef((e,t)=>{let{__scopeForm:r,...i}=e,s=g(E,r),u=S(E,r),d=v(E,r),f=c.useRef(null),p=o(t,f),m=i.name||u.name,h=i.id||u.id,_=s.getFieldCustomMatcherEntries(m),{onFieldValidityChange:y,onFieldCustomErrorsChange:b,onFieldValiditionClear:x}=s,C=c.useCallback(async e=>{if(q(e.validity)){y(m,z(e.validity));return}let t=e.form?new FormData(e.form):new FormData,n=[e.value,t],r=[],i=[];_.forEach(e=>{W(e,n)?i.push(e):G(e)&&r.push(e)});let a=r.map(({id:e,match:t})=>[e,t(...n)]),o=Object.fromEntries(a),s=Object.values(o).some(Boolean),c=s;if(e.setCustomValidity(c?O:``),y(m,z(e.validity)),b(m,o),!s&&i.length>0){let t=i.map(({id:e,match:t})=>t(...n).then(t=>[e,t])),r=await Promise.all(t),a=Object.fromEntries(r),o=Object.values(a).some(Boolean);e.setCustomValidity(o?O:``),y(m,z(e.validity)),b(m,a)}},[_,m,b,y]);c.useEffect(()=>{let e=f.current;if(e){let t=()=>C(e);return e.addEventListener(`change`,t),()=>e.removeEventListener(`change`,t)}},[C]);let w=c.useCallback(()=>{let e=f.current;e&&(e.setCustomValidity(``),x(m))},[m,x]);c.useEffect(()=>{let e=f.current?.form;if(e)return e.addEventListener(`reset`,w),()=>e.removeEventListener(`reset`,w)},[w]),c.useEffect(()=>{let e=f.current,t=e?.closest(`form`);if(t&&u.serverInvalid){let n=U(t);n===e&&n.focus()}},[u.serverInvalid]);let T=s.getFieldValidity(m);return(0,l.jsx)(n.input,{"data-valid":J(T,u.serverInvalid),"data-invalid":Y(T,u.serverInvalid),"aria-invalid":u.serverInvalid?!0:void 0,"aria-describedby":d.getFieldDescription(m),title:``,...i,ref:p,id:h,name:m,onInvalid:a(e.onInvalid,e=>{let t=e.currentTarget;C(t)}),onChange:a(e.onChange,e=>{w()})})});D.displayName=E;var O=`This value is not valid`,k={badInput:O,patternMismatch:`This value does not match the required pattern`,rangeOverflow:`This value is too large`,rangeUnderflow:`This value is too small`,stepMismatch:`This value does not match the required step`,tooLong:`This value is too long`,tooShort:`This value is too short`,typeMismatch:`This value does not match the required type`,valid:void 0,valueMissing:`This value is missing`},A=`FormMessage`,j=c.forwardRef((e,t)=>{let{match:n,name:r,...i}=e,a=S(A,e.__scopeForm),o=r??a.name;return n===void 0?(0,l.jsx)(P,{...i,ref:t,name:o,children:e.children||O}):typeof n==`function`?(0,l.jsx)(N,{match:n,...i,ref:t,name:o}):(0,l.jsx)(M,{match:n,...i,ref:t,name:o})});j.displayName=A;var M=c.forwardRef((e,t)=>{let{match:n,forceMatch:r=!1,name:i,children:a,...o}=e,s=g(A,o.__scopeForm).getFieldValidity(i);return r||s?.[n]?(0,l.jsx)(P,{ref:t,...o,name:i,children:a??k[n]}):null}),N=c.forwardRef((e,t)=>{let{match:n,forceMatch:r=!1,name:i,id:a,children:u,...d}=e,f=g(A,d.__scopeForm),p=o(t,c.useRef(null)),m=s(),h=a??m,_=c.useMemo(()=>({id:h,match:n}),[h,n]),{onFieldCustomMatcherEntryAdd:v,onFieldCustomMatcherEntryRemove:y}=f;c.useEffect(()=>(v(i,_),()=>y(i,_.id)),[_,i,v,y]);let b=f.getFieldValidity(i),x=f.getFieldCustomErrors(i)[h];return r||b&&!q(b)&&x?(0,l.jsx)(P,{id:h,ref:p,...d,name:i,children:u??O}):null}),P=c.forwardRef((e,t)=>{let{__scopeForm:r,id:i,name:a,...o}=e,u=v(A,r),d=s(),f=i??d,{onFieldMessageIdAdd:p,onFieldMessageIdRemove:m}=u;return c.useEffect(()=>(p(a,f),()=>m(a,f)),[a,f,p,m]),(0,l.jsx)(n.span,{id:f,...o,ref:t})}),F=`FormValidityState`,I=e=>{let{__scopeForm:t,name:n,children:r}=e,i=g(F,t),a=S(F,t),o=n??a.name;return(0,l.jsx)(l.Fragment,{children:r(i.getFieldValidity(o))})};I.displayName=F;var L=`FormSubmit`,R=c.forwardRef((e,t)=>{let{__scopeForm:r,...i}=e;return(0,l.jsx)(n.button,{type:`submit`,...i,ref:t})});R.displayName=L;function z(e){let t={};for(let n in e)t[n]=e[n];return t}function B(e){return e instanceof HTMLElement}function V(e){return`validity`in e}function H(e){return V(e)&&(e.validity.valid===!1||e.getAttribute(`aria-invalid`)===`true`)}function U(e){let t=e.elements,[n]=Array.from(t).filter(B).filter(H);return n}function W(e,t){return e.match.constructor.name===`AsyncFunction`||K(e.match,t)}function G(e){return e.match.constructor.name===`Function`}function K(e,t){return e(...t)instanceof Promise}function q(e){let t=!1;for(let n in e){let r=n;if(r!==`valid`&&r!==`customError`&&e[r]){t=!0;break}}return t}function J(e,t){if(e?.valid===!0&&!t)return!0}function Y(e,t){if(e?.valid===!1||t)return!0}var X=y;export{X as t};